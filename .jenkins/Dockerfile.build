FROM python:3.8.5

RUN apt-get update && \
    apt-get install -y bash jq && \
    pip install --upgrade poetry mypy2junit==1.6.0

ADD pyproject.toml /build/
ADD poetry.lock /build/

RUN cd /build && poetry install --no-root

ADD mypy.ini /build/

ADD ampel /build/ampel
RUN cd /build && poetry install

RUN chmod -R og+rx /root/.cache/pypoetry/virtualenvs

